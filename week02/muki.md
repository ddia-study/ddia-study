# 2장 - 데이터 모델과 질의 언어

- 데이터 모델 : 문제를 어떻게 생각해야 하는지에 막대한 영향을 미침
- 계층의 핵심적인 문제 - 다음 하위계층 관점에서 데이터 모델을 표현하는 방법
    - step 1 어플리케이션 = 현실 → 객체, api 모델링
    
    ex) 데이터 구조 = JSON, XML, RDB 등을 사용한 데이터 구조
    
    - step 2 DB 엔지니어 = JSON, XML 등의 데이터 구조 → 디스크 네트워크 상의 바이트
    
    - step 3 하드웨어 엔지니어 = 바이트 → 전류, 빛의 파동, 자기장
    
- 명확한 데이터 모델을 통해 하위 계층의 복잡성을 숨김
- 다양한 범용 데이터 모델을 살펴볼 예정step 1(2장) + 데이터 모델을 통해 실제로 어떻게 구현step2(3장)

---

- 관계형 모델과 문서 모델
    - 1960년대 : 비즈니스 데이터 처리 = 트랜젝션 처리(은행 거래, 항공 예약) + 일괄처리(급여지불, 보고) → 세부 사항 숨기기 필요
    - 1970년 : 에드가 코드의 관계형 모델 - 관계(테이블), 튜플 모음
    - 1980년 중반 : RDBMS 와 SQL로 대부분이 관계형 모델 채택
    - 1980년 후반 ~ 1990초반 :객체 DB
    - 2000년 초반 : XML DB
    
    - NoSQL
        - Not Only SQL
        - 2010 년대
        - 배경
            1. 대규모 데이터 셋이나 높은 throughput
            2. 상용 DB 보다 무료 OpenSoftware 선호
            3. 특수 질의
            4. 관계형 스키마 제한에 대한 불만 + 동적 + 풍부한 데이터 모델에 대한 바람
        
        - 다중 저장소 지속성 : “관계형 DB가 폭넓은 다양함을 가진 비관계형 데이터 스토어와 함께 사용됨” > 상황에 따라 최적의 db 선택
        
    - 객체 관계형 불일치
        - 임피던스 불일치 : 데이터 → DB 저장시에 ap 코드 → db 모델 다름, 모델 사이의 분리
        - JSON 모델 등으 ㄹ사용해서 임피던스 불일치를 줄이지만 JSON이 가진 문제도 있음 → 4장
    
    - 다대일 다대다 관계
        - 다대일을 통한 장점
            - 일관된 양식 유지 + 모호함 회피
            - 더 나은 검색 + 갱신의 편의성
        - 다 대일 시의 ID 값은 의미 X → 의미가 생기면 중복 발생 → write overhead + 정합성 문제
        
        - 문서 데이터베이스에서는 조인에 대한 지원이 약하다 (mongoDB 지원X)
            - 다중 질의로 조인을 흉내내게 됨
            - ap 기능이 추가되면서 데이터가 연결되는 경향 가짐
            
    - 문서 데이터베이스는 역사를 반복하고 있나?
        
        1970 년대 : IBM의 IMS
        
        - 계층 모델이 현재의 JSON 모델과 유사
        - 모든 데이터를 레코드 내의 중첩된 레코드 트리로 표현
        
        계층 모델의 한계 해결책 - 관계형 모델 + 네트워크 모델
        
    
    - 네트워크 모델
        - 코다실(CODASYL) 위원회 표준, 코다실 모델이라고 부름
        - 다중 부모 가능 - 다대일 과 다대다 관계 모델링 가능
        - 포인터 개념과 유사 - 최상위 레코드에서 연속된 연결로 따라 들어감
        - 복잡과 수정에 용이하지 않음
    
    - 관계형 모델
        - query optimizer가 질의를 최적화 해줌
    
    - 문서 데이터 베이스 vs 관계형 데이터 베이스
        - 관계형 모델에서의 외래 키 = 문서 모델에서의 ‘문서 참조’
        
        - 문서 데이터 모델 : 스키마 유연성, 지역성이 좋음 → 성능 좋음, 데이터의 구조가 자주 변하는 경우
        - 관계형 데이터 모델 : 조인, 다대일, 다대다 관계를 더 잘 지원함
        
        - ap 데이터가 문서와 비슷한 구조?(일대 다 관계 트리) → 문서 모델 사용
        - 다대다의 관계가 많다 → 관계형 모델 사용
        
        - 스키마를 변경시에 문서형은 새로운 필드를 가진 문서를 생성 ap 단에서 기존형태의 문서를 읽을 때의 로직만 처리 vs 관계형의 경우 마이그레이션을 진행(중단 시간)
        
    - 문서 데이터 베이스
        - 쓰기 스키마 : 관계형 db에서 사용 - 스키마가 명시적이고 쓰여진 모든 데이터가 스키마를 따름을 보장)
            - 정적 타입 확인과 유사(컴파일 타임)
        - 읽기 스키마 : 문서형 db에서 사용 - 데이터 구조는 암묵적이고 읽을 때만 해석됨
            - 동적 타입 확인과 유사(런타임)
    
    - 지역성
        - 문서 데이터 베이스가 지역성에 유리
        - 오라클 - 다중 테이블 색인 클러스터 테이블 기능으로 동일한 특성 제공
    
    - 데이터를 위한 질의 언어
        
        선언형 질의 언어 (SQL) : 결과가 충족해야 하는 조건과 데이터를 변환
        
        - 질의를 변형하지 않고도 성능 향상 가능, 병렬 처리에 유리
        
        명령형 질의 언어 (IMS, 코다실) : 특정 순서로 특정 연산을 수행하게 끔함 (방법)
        
    
    - 맵리듀스 질의
        - 많은 컴퓨터에서 대량의 데이터를 처리하기 위한 프로그래밍 모델
        - 선언형, 명령형 사이의 질의
        - 맵(일치하는 데이터 찾기) 과 리듀스(데이터 처리) 로 이루어짐
    

- 그래프형 데이터 모델
    - 다대다 관계를 표현하는 모델 → 그래프 사용
    - 속성 그래프 모델, 트리플 저장소 모델
    - 그래프용 선언형 질의 언어 : 사이퍼, 스파클, 데이터로그
    
    - 속성 그래프
        - 정점 : 고유한 식별자 + 유출 간선 집합 + 유입 간선 집합 + 속성 컬렉션
        - 간선 : 고유한 식별자  + 간선이 시작하는 정점 + 간선이 끝나는 정점 + 두 정점 간의 관계 유형 레이블 + 속성 컬렉션
        - 발전성이 좋아 ap에 기능을 추가하는 경우 데이터 구조 변경을 용의하게 함 + 확장성
    
    - 사이퍼 질의 언어
        - 네오제이 그래프 데이터베이스 용
        - 시작 정점 ‘→’ 도착정점
        
    - 트리플 저장소와 스파클
        - 주어, 서술어, 목적어 처럼 매우 간단한 세 부분 구문 형식으로 저장
        - 주어 : 그래프의 정점과 유사
        - 목적어 : 그래프의 다른 정점 or 문자열이나 숫자 같은 원시 데이터타입의 값
        - 서술어 : 속성,..
    
    ?트리플 저장소 → 시맨틱 웹 → RDF 데이터 모델?
    
    - 스파클 질의 언어
        - RDF 데이터 모델을 사용한 트리플 저장소의 질의 언어
    - 데이터 로그
        - 1980년대 개발
        - 서술어(주어, 목적어) 형태로 작성 - 새로운 서술어를 데이터베이스에 전달하는 규칙을 정의
        - 다른 질의의 규칙을 결합하거나 재사용할 수 있기에 강력한 접근 방식
        - 
    - 그래프 데이터 베이스 vs 네트워크 모델
        - 레코드 타입 제한
            - 네트워크 모델 : 다른 레코드 타입과 중첩 가능한 레코드 타입을 지정하는 스키마가 있다.
            - 그래프 db : 제한 X
        - 특정 레코드 도달하는 방법
            - 네트워크 모델 : 레코드의 접근 경로 중 하나를 탐색
            - 그래프 db: 고유 ID를 가지고 임의 정점 직접 참조 or index로 특정 값을 가진 정점 탐색
        - 정렬 여부
            - 네트워크 모델 : 정렬을 유지해야 함
            - 그래프 db : 정점과 간선은 정렬하지 않음
        - 질의
            - 네트워크 모델 : 질의가 모두 명령형 + 작성이 어려움 + 스키마가 변경되면 질의 쉽게 손상
            - 그래프 db : 사이퍼, 스파클 등의 고수준 선언형 질의 언어 제공
    

- 정리
    - 역사적으로 데이터를 하나의 트리로 표현하려 했지만 다대다 관계에는 트리구조가 적절하지 않음 → 관계형 모델 고안
    - 관계형 모델 적합하지 않은 ap → 비관계형 데이터 저장소 NoSQL(문서 데이터 베이스 , 그래프 데이터 베이스)
    - 각 데이터 모델은 고유한 질의 언어나 프레임 워크를 제공

결론

**한번 읽어선 택도 없다.**